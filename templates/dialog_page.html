{% extends 'base.html' %}

{% block links %}
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/dialog_page.css') }}">
{% endblock %}

{% block content %}
<h1>Диалог с {{ user_to.nickname }}</h1>

<a href="#" onclick="history.back()" class="btn btn-secondary fixed" style="font-size: 35px">⟽</a>
<a href="{{ url_for('users_dialog', id_from=current_user.id, id_to=user_to.id) }}{% if messages %}#message_{{ messages[-1].id }}{% endif %}" class="btn btn-primary rounded-fixed" style="font-size: 35px">⇓</a>

<div id="dialog-card" class="card">
    <div class="card-body">
        {% for message in messages %}
        {% if message.user_from == current_user %}
            <div style="color: gray; text-align: right">{{ moment(message.send_date).format('LLL') }}</div>
            <div id="message_{{ message.id }}" class="alert alert-primary user-from-message">{% if not message.is_read %}<span style="color: orangered">Не прочитано - </span>{% endif %}{{ message.content }}</div>
        {% else %}
            <div style="color: gray">{{ moment(message.send_date).format('LLL') }}</div>
            <div id="message_{{ message.id }}" class="alert alert-secondary user-to-message">{{ message.content }}</div>
        {% endif %}
        {% endfor %}
    </div>

    <div class="card-footer">
        <form method="post">
            {{ form.message.label }}{{ form.message(class="form-control") }}{{ form.submit(type="submit", class="btn btn-primary") }}
        </form>
    </div>
</div>
{% endblock %}
